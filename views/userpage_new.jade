doc
html(lang='en')
head
  meta(charset='utf-8')     
  meta(http-equiv='X-UA-Compatible', content='IE=edge')     
  meta(name='viewport', content='width=device-width, initial-scale=1')
  //meta(name='yandex-verification' content='6ea94f8807d25ebe')
  // The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags
  title AC notes     
  link(rel='icon', href='', sizes='16x16', type='image/png')
  // Bootstrap
  link(href='/bootstrap/css/bootstrap.min.css', rel='stylesheet')     
  meta(liber de amicitia est)
  // HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries
  // WARNING: Respond.js doesn't work if you view the page via file://
  //if lt IE 9
  script(src='https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js') 
  script(src='https://oss.maxcdn.com/respond/1.4.2/respond.min.js')     
  style.
    body2{
    height:100%;
    background: #2eb9c9; /* Old browsers */
    background: -moz-linear-gradient(top, #00afce 0%, #00809e 35%, #004f71 100%); /* FF3.6+ */
    background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#00afce), color-stop(35%,#00809e), color-stop(100%,#004f71)); /* Chrome,Safari4+ */
    background: -webkit-linear-gradient(top, #00afce 0%,#00809e 35%,#004f71 100%); /* Chrome10+,Safari5.1+ */
    background: -o-linear-gradient(top, #00afce 0%,#00809e 35%,#004f71 100%); /* Opera 11.10+ */
    background: -ms-linear-gradient(top, #00afce 0%,#00809e 35%,#004f71 100%); /* IE10+ */
    background: linear-gradient(to bottom, #00afce 0%,#00809e 35%,#004f71 100%); /* W3C */
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#00afce', endColorstr='#004f71',GradientType=0 ); /* IE6-9 */
    }
    body{
      height:100%;
     /* background-color:#{color};*/
     background-color:white;
    }
    html2 { 
      background: url('/images/libr.jpg') no-repeat center center fixed; 
      -webkit-background-size: cover;
      -moz-background-size: cover;
      -o-background-size: cover;
      background-size: cover;
    }
    body2{
      background-color:transparent;
    }
    .change_phc::-webkit-input-placeholder {color:#ddd;}
    .change_phc::-moz-placeholder          {color:#ddd;}/* Firefox 19+ */
    .change_phc:-moz-placeholder           {color:#ddd;}/* Firefox 18- */
    .change_phc:-ms-input-placeholder      {color:#ddd;}
    .change_phc {
      color:white;
    }
    .signinlink{
      margin-top:30px;
    }
    .signinlink:focus, .signinlink:hover, .signinlink:active {
      color:white;
    }
    #signup {
      margin-top:50px;
    }
    #signupround {
      margin-top:60px;
    }
    #signupbutton {
      margin-top:30px;
    }
    #mainheading {
      text-align:center;
      margin-top:20px;
    }
    .inputwrap input{
     -webkit-appearance: none;
      border-radius: 0;
      width:100%;
      padding: 11px 10px 11px 13px;
      font-size: 14px;
      line-height: 1.42857143;
      color: #555;
      border:none;
      border-bottom:1px solid #ddd;
    }
    .form-control-feedback {
      top:4px;
      right:4px;
    }
    @media (max-width: 992px) {
        .inputwrap input{
      font-size: 20px !important;
      line-height: 2 !important;
    }
    .form-control-feedback {
      top:16px;
      right:6px;
    }
    p {
      font-size:20px;
    }
    .btn-lg {
      height:60px;
      font-size: 22;
    }
    .signinlink {
      font-size: 22;
    }
    }
    @media (max-width: 767px) {
    h1 {
      font-size:32px;
    }
    .signinlink {
     margin-top:20px;
      }
    #mainheading {
      margin-top: 10px;
    }
    }
    @font-face {
    font-family:roboto-thin;
    src: url('/bootstrap/fonts/Roboto-Thin.ttf');
    }
    @font-face{
    font-family:proxima;
    src:url('/bootstrap/fonts/ProximaNova-Reg-webfont.woff');
    }
    @font-face{
    font-family:boldproxima;
    src:url('/bootstrap/fonts/ProximaNova-Sbold-webfont.woff');
    }
    .loader {
    margin: 60px auto;
    margin-top:20%;
    font-size: 10px;
    position: relative;
    text-indent: -9999em;
    border-top: 1.1em solid rgba(255, 255, 255, 0.2);
    border-right: 1.1em solid rgba(255, 255, 255, 0.2);
    border-bottom: 1.1em solid rgba(255, 255, 255, 0.2);
    border-left: 1.1em solid #ffffff;
    -webkit-transform: translateZ(0);
    -ms-transform: translateZ(0);
    transform: translateZ(0);
    -webkit-animation: load8 1.1s infinite linear;
    animation: load8 1.1s infinite linear;
    }
    .loader,
    .loader:after {
      border-radius: 50%;
      width: 10em;
      height: 10em;
    }
    @-webkit-keyframes load8 {
      0% {
        -webkit-transform: rotate(0deg);
        transform: rotate(0deg);
      }
      100% {
        -webkit-transform: rotate(360deg);
        transform: rotate(360deg);
      }
    }
    @keyframes load8 {
      0% {
        -webkit-transform: rotate(0deg);
        transform: rotate(0deg);
      }
      100% {
        -webkit-transform: rotate(360deg);
        transform: rotate(360deg);
      }
    }
    .inputwrap input{
      font-weight: 500;
     letter-spacing: 1px;
     -webkit-appearance: none;
      border-radius: 0;
      width:100%;
      padding: 11px 10px 11px 13px;
      font-size: 14px;
      line-height: 1.42857143;
      color: #555;
      border:none;
      border-bottom:1px solid #ddd;
    }
    .inputwrap input:first-child {
    -webkit-appearance: none;
    border-radius: 0;
    border-top-left-radius:4px;
    border-top-right-radius:4px;
    border-bottom:none;
    border-bottom: 1px solid #ddd;
    }
    .inputwrap input:last-child {
     -webkit-appearance: none;
    border-radius: 0;
    border-bottom-left-radius:4px;
    border-bottom-right-radius:4px;
    border:none;
    }
    .inputwrap {
      margin-bottom:20px;
    }
    .simplebox {
      outline: none;
      -webkit-box-shadow: none !important;
      -moz-box-shadow: none !important;
      box-shadow: none !important;
    }
    .form-group{
      margin:0px;
    }
    .has-success .form-control-feedback {
    color: #61C782;
    }
    .btn:focus,.btn:active {
       outline: none !important;
    }
    .checkbox label {
    padding-left: 35px;
    }
    #termsrow {
      display:none;
    }
    .modal-header {
      border:none;
    }
    .modal-body{
      padding-top:0px;
    }
    .btn-iosdark {
      background-color:white;
      border:1px solid #333;
      color:#333;
    }
    .btn-iosdark:focus, .btn-iosdark:active, .btn-iosdark:hover {
      background-color:#333;
      color:white;
    }
    .btn-iosdark.active {
      background-color:#333;
      color:white;
    }
    .btn-simple {
      border:none;
      background-color:white;
      color:#2E98F3;
    }
    .btn-blue {
      border-color:#2E98F3;
      background-color:#2E98F3;
      color:white;
    }
    h4 {
      margin-bottom:20px;
    }
    #pwderr {
      background-color:rgba(0, 0, 0, 0.43);
      border-radius:4px;
      color:white;
      display:none;
      padding:20px 16px;
      margin-top:20px;
    }
    .language {
      position:absolute;
      top:20px;
      right:20px;
      color:rgba(0,0,0,0.3) !important;
      }
    .language a,.language a:focus,.language a:active,.language a:hover {
      color:rgba(0,0,0,0.3);
    }
    .modal-header {
    border-top-left-radius: 6px;
    border-top-right-radius: 6px;
    background-color: #333;
    }
    .modal-content{
      border:none;
      box-shadow:none;
    }
    .modal-footer {
      padding-top:0px;
      border-top:0px;
    }
    .week .col-xs-12{
      background-color:#fbfbfb;
      color:#ddd;
      text-align:center;
      border-bottom:1px solid #eee;
    }
  body
    //.language
    //  a#eng Login
    //background-color:#FF9C47;:#e87e22 round button color
    .modal.fade(id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel")
      .modal-dialog(role="document")
        .modal-content
          .modal-header
            button(type="button" class="close" data-dismiss="modal" aria-label="Close")
              span(aria-hidden="true") Ã—
            h4(class="modal-title"  style='color:#ddd;') Adding a link
          .modal-body
            form
              .form-group
                .message
              .inputwrap
                #mailgroup.form-group.has-feedback
                  input(type="text" class="change_phc simplebox" id="link" name='link' placeholder="link") 
                  span(id='mail_error' style='display:none;' class="glyphicon glyphicon-remove form-control-feedback" aria-hidden="true")
                  span(id='mail_success'  style='display:none;' class="glyphicon glyphicon-ok form-control-feedback" maxlength="35" aria-hidden="true")
                #pgroup.form-group.has-feedback
                  span(id='p_error' style='display:none;' class="glyphicon glyphicon-remove form-control-feedback" aria-hidden="true")
                  input(type="text" class=" change_phc simplebox" id="title" name='p' maxlength="15" placeholder="description") 
                  span(id='p_success'  style='display:none;' class="glyphicon glyphicon-ok form-control-feedback" aria-hidden="true")
                #nickgroup.form-group.has-feedback
                  span(id='nick_error' style='display:none;' class="glyphicon glyphicon-remove form-control-feedback" aria-hidden="true")
                  span(id='nick_success'  style='display:none;' class="glyphicon glyphicon-ok form-control-feedback" aria-hidden="true")
                  input(type="text" class="change_phc simplebox" id='comment' name='nick' placeholder="comment" maxlength="20")
              //button.btn.btn-lg.btn-primary.runreg(type='button' style='min-height:40px;background-color:rgba(8, 8, 8, 0.5);border:none;width:100%;text-transform:uppercase;letter-spacing:2px;') Login
           .modal-footer
             button(class="btn btn-default" data-dismiss="modal") Close
             button#submitlink(class="btn btn-primary") Add
    .container(id='wait' style='background-color:rgba(0, 0, 0, 0.63);position:fixed;width:100%;height:100%;z-index:9999;display:none;')
      .row(id='spin') 
        .col-xs-12(style='text-align:center;')
          .loader       
    .container
      #mainheading.row(style='padding-bottom:20px;border-bottom:1px solid #eee;')
        .col-xs-12
          h1(style='text-transform:uppercase;letter-spacing:4px;font-weight:100;color:black;font-family:boldproxima;') Neural Networks Research
          button#addlink(class=' btn btn-primary') + add a link
      .row
        #list.row
          .col-xs-12.col-lg-10.col-lg-offfset-1.col-md-10.col-md-offset-1               
            .row.brow
              .col-xs-12.visible-lg.visible-md.visible-sm.items#bigscreens
                .noitems.row(style='text-align:center;')  
                   .col-xs-12
                     h2.noitems_text(style='color:#ccc;margin-top:50px;') No items  
            .row.brow
              #smallscreens.visible-xs.col-xs-12.items(style='border-top:1px solid #eee;')         
                .noitems.row(style='text-align:center;')  
                   .col-xs-12
                     h2.noitems_text(style='color:#ccc;margin-top:50px;') No items 
    // jQuery (necessary for Bootstrap's JavaScript plugins)
    //script(src='https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js')
    // Include all compiled plugins (below), or include individual files as needed
    script(src='js/jquery.min.js')
    script(src='js/bootstrap.min.js') 
    //script(async src='js/counter.js')    
    script.
      $('#addlink').click(function(){
        $('#myModal').modal('show');
        });
       var consolidated=[];
       $.ajax({
              method: "POST",
              url: "/getitems",
              data: 0
            }).done(function( msg ) {
                console.log('hey! '+msg);
                if(!msg.trouble) {
                   items=msg.doc;
                  if(!items || !items.length) {
                   console.log('no items');
                   }
                   else {
                    items.forEach(function (element,index){
                    element.item_type = 'article';
                    consolidated.push(element);
                    });
                   }
                   if(consolidated.length){
                    console.log(consolidated);
                   sortByKey(consolidated, 'tmstmp');
                   populate(consolidated);
                 }
                }
              });
      function sortByKey(array, key) {
           return array.sort(function(a, b) {
              var x = parseInt(a[key]); var y = parseInt(b[key]);
              return ((x < y) ? -1 : ((x > y) ? 1 : 0));
          });
       }
      function populate(consolidated) {
      var last_item_over = consolidated[consolidated.length-1];
      var weeknum_g=new Date(last_item_over.tmstmp).getWeek();
       consolidated.forEach(function (element,index){
         if ($(".noitems")[0])
                 { console.log('HAS LENGTH');
                   $('.items').empty();}
                 else {
                   console.log('HASNT GOT LENGTH');
                 }
         var insert;
         switch(element.item_type){
           case('article'):
              var authors_insert=' ';
                 if(element.authors&&element.authors[0]){
                   element.authors.forEach(function(element2){
                   authors_insert+='  '+element2;
                    });
                   element.authors = authors_insert;
                 }
                insert = "<div class='row item read book"+element._id+"'><div class='col-xs-12 good bookpadding hovershade' onclick='redactbookmodal("+index+");'><h3 class='visible-xs'><span class='label label-book'>BOOK</span><span class='label label-good'>GOOD</span></h3><h3 class='btitle"+element._id+"' ><span class='label label-book hidden-xs' > BOOK </span><span class='label label-good hidden-xs' > GOOD </span>"+element.title.capitalizeFirstLetter()+"<small class='hidden-xs' >"+authors_insert+"</small></h3><h5 class='hidden-lg hidden-md hidden-sm sm_hd"+element._id+"'>"+authors_insert+"</h5></div></div>";  
                var weeknum = new Date(parseInt(element.tmstmp));
                weeknum = weeknum.getWeek();
                var week = "<div class='row item week week"+weeknum_g+"'><div class='col-xs-12'><h5>"+weektxt+" "+weeknum_g+"</h5></div></div>";
                var weekname = '.week'+weeknum;
                //if(!$(weekname)[0])
                if(weeknum>weeknum_g )
                {$('.items').prepend(week); }  
                weeknum_g = weeknum;   
                $('.items').prepend(insert);
                if(index === consolidated.length-1) {
                  var week = "<div class='row item week week"+weeknum+"'><div class='col-xs-12'><h5>"+weektxt+" "+weeknum+"</h5></div></div>";
                  $('.items').prepend(week);
                }
           break;
         }
         });
        };
        //-----------------------------------//
        $('#submitlink').click(function(){
        if($('#title').val() && $('#link').val() )
        { // TO DO now we use modals, this should be adapted to such, and it has a part in the end of this function
          $('#add').fadeOut(350);
          $('#wait').css('display','block');
          //-------------
           var data={};
           data.title = $('#title').val();
           data.link = $('#link').val();
           data.comment = $('#comment').val();
           console.log(JSON.stringify(data));
          $.ajax({
              method: "POST",
              url: "/additem/link",
              data: data
            })
              .done(function( msg ) {
                $('#title').val('');
                $('#link').val('');
                $('#comment').val('');
                $('#mymodal').modal('hide');
                //$('#wait').fadeOut(350);
                //console.log(msg);
                window.location='/';
              });
          }
        });
        