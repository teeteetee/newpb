doc
html(lang='en')
head
  meta(charset='utf-8')     
  meta(http-equiv='X-UA-Compatible', content='IE=edge')     
  meta(name='viewport', content='width=device-width, initial-scale=1')
  meta(name='yandex-verification' content='6ea94f8807d25ebe')
  // The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags
  title AC notes     
  link(rel='icon', href='', sizes='16x16', type='image/png')
  // Bootstrap
  link(href='/bootstrap/css/bootstrap.min.css', rel='stylesheet')  
  link(href='/bootstrap/css/sticky-footer.css', rel='stylesheet')     
  meta(liber de amicitia est)
  // HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries
  // WARNING: Respond.js doesn't work if you view the page via file://
  //if lt IE 9
  script(src='https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js') 
  script(src='https://oss.maxcdn.com/respond/1.4.2/respond.min.js')     
  style.
    body2{
    height:100%;
    background: #2eb9c9; /* Old browsers */
    background: -moz-linear-gradient(top, #00afce 0%, #00809e 35%, #004f71 100%); /* FF3.6+ */
    background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#00afce), color-stop(35%,#00809e), color-stop(100%,#004f71)); /* Chrome,Safari4+ */
    background: -webkit-linear-gradient(top, #00afce 0%,#00809e 35%,#004f71 100%); /* Chrome10+,Safari5.1+ */
    background: -o-linear-gradient(top, #00afce 0%,#00809e 35%,#004f71 100%); /* Opera 11.10+ */
    background: -ms-linear-gradient(top, #00afce 0%,#00809e 35%,#004f71 100%); /* IE10+ */
    background: linear-gradient(to bottom, #00afce 0%,#00809e 35%,#004f71 100%); /* W3C */
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#00afce', endColorstr='#004f71',GradientType=0 ); /* IE6-9 */
    }
    body{
      height:100%;
     /* background-color:#{color};*/
     background-color:white;
     margin-bottom: 0px;
    }
    html {
    position: relative;
    min-height: 100%;
    }
    html2 { 
      background: url('/images/libr.jpg') no-repeat center center fixed; 
      -webkit-background-size: cover;
      -moz-background-size: cover;
      -o-background-size: cover;
      background-size: cover;
    }
    body2{
      background-color:transparent;
    }
    .change_phc::-webkit-input-placeholder {color:#ddd;}
    .change_phc::-moz-placeholder          {color:#ddd;}/* Firefox 19+ */
    .change_phc:-moz-placeholder           {color:#ddd;}/* Firefox 18- */
    .change_phc:-ms-input-placeholder      {color:#ddd;}
    .change_phc {
      color:white;
    }
    .signinlink{
      margin-top:30px;
    }
    .signinlink:focus, .signinlink:hover, .signinlink:active {
      color:white;
    }
    #signup {
      margin-top:50px;
    }
    #signupround {
      margin-top:60px;
    }
    #signupbutton {
      margin-top:30px;
    }
    #mainheading {
      text-align:center;
      margin-top:20px;
    }
    .inputwrap input{
     -webkit-appearance: none;
      border-radius: 0;
      width:100%;
      padding: 11px 10px 11px 13px;
      font-size: 14px;
      line-height: 1.42857143;
      color: #555;
      border:none;
      border-bottom:1px solid #ddd;
    }
    .form-control-feedback {
      top:4px;
      right:4px;
    }
    @media (max-width: 992px) {
        .inputwrap input{
      font-size: 20px !important;
      line-height: 2 !important;
    }
    .form-control-feedback {
      top:16px;
      right:6px;
    }
    p {
      font-size:20px;
    }
    .btn-lg {
      height:60px;
      font-size: 22;
    }
    .signinlink {
      font-size: 22;
    }
    }
    @media (max-width: 767px) {
    h1 {
      font-size:32px;
    }
    .signinlink {
     margin-top:20px;
      }
    #mainheading {
      margin-top: 10px;
    }
    .bookpadding {
     padding-left:21px;
     padding-right:21px;
    }
    }
    @media (min-width: 768px) {
    .navbar-centered .navbar-nav {
        float: none;
        text-align: center;
    }
    .navbar-centered .navbar-nav > li {
        float: none;
    }
    .navbar-centered .nav > li {
        display: inline;
    }
    .navbar-centered .nav > li > a {
        display: inline-block;
    }
    } 
    @font-face {
    font-family:roboto-thin;
    src: url('/bootstrap/fonts/Roboto-Thin.ttf');
    }
    @font-face{
    font-family:proxima;
    src:url('/bootstrap/fonts/ProximaNova-Reg-webfont.woff');
    }
    @font-face{
    font-family:boldproxima;
    src:url('/bootstrap/fonts/ProximaNova-Sbold-webfont.woff');
    }
    .loader {
    margin: 60px auto;
    margin-top:20%;
    font-size: 10px;
    position: relative;
    text-indent: -9999em;
    border-top: 1.1em solid rgba(255, 255, 255, 0.2);
    border-right: 1.1em solid rgba(255, 255, 255, 0.2);
    border-bottom: 1.1em solid rgba(255, 255, 255, 0.2);
    border-left: 1.1em solid #ffffff;
    -webkit-transform: translateZ(0);
    -ms-transform: translateZ(0);
    transform: translateZ(0);
    -webkit-animation: load8 1.1s infinite linear;
    animation: load8 1.1s infinite linear;
    }
    .loader,
    .loader:after {
      border-radius: 50%;
      width: 10em;
      height: 10em;
    }
    @-webkit-keyframes load8 {
      0% {
        -webkit-transform: rotate(0deg);
        transform: rotate(0deg);
      }
      100% {
        -webkit-transform: rotate(360deg);
        transform: rotate(360deg);
      }
    }
    @keyframes load8 {
      0% {
        -webkit-transform: rotate(0deg);
        transform: rotate(0deg);
      }
      100% {
        -webkit-transform: rotate(360deg);
        transform: rotate(360deg);
      }
    }
    .inputwrap input{
      font-weight: 500;
     letter-spacing: 1px;
     -webkit-appearance: none;
      border-radius: 0;
      width:100%;
      padding: 11px 10px 11px 13px;
      font-size: 14px;
      line-height: 1.42857143;
      color: #555;
      border:none;
      border-bottom:1px solid #ddd;
    }
    .inputwrap input:first-child {
    -webkit-appearance: none;
    border-radius: 0;
    border-top-left-radius:4px;
    border-top-right-radius:4px;
    border-bottom:none;
    border-bottom: 1px solid #ddd;
    }
    .inputwrap input:last-child {
     -webkit-appearance: none;
    border-radius: 0;
    border-bottom-left-radius:4px;
    border-bottom-right-radius:4px;
    border:none;
    }
    .inputwrap {
      margin-bottom:20px;
    }
    .simplebox {
      outline: none;
      -webkit-box-shadow: none !important;
      -moz-box-shadow: none !important;
      box-shadow: none !important;
    }
    .form-group{
      margin:0px;
    }
    .has-success .form-control-feedback {
    color: #61C782;
    }
    .btn:focus,.btn:active {
       outline: none !important;
    }
    .checkbox label {
    padding-left: 35px;
    }
    #termsrow {
      display:none;
    }
    .modal-header {
      border:none;
    }
    .modal-body{
      padding-top:0px;
    }
    h4 {
      margin-bottom:20px;
      margin-top:20px;
      font-weight:200;
    }
    h4 strong {
      font-weight:500;
    }
    #pwderr {
      background-color:rgba(0, 0, 0, 0.43);
      border-radius:4px;
      color:white;
      display:none;
      padding:20px 16px;
      margin-top:20px;
    }
    .language {
      position:absolute;
      top:20px;
      right:20px;
      color:rgba(0,0,0,0.3) !important;
      }
    .language a,.language a:focus,.language a:active,.language a:hover {
      color:rgba(0,0,0,0.3);
    }
    .modal-header {
    border-top-left-radius: 6px;
    border-top-right-radius: 6px;
    background-color: #333;
    }
    .modal-content{
      border:none;
      box-shadow:none;
    }
    .week {
      padding-top:10px;
      padding-bottom:10px;
    }
    .week .col-sm-2{
      color: #333;
      text-align:center;
    }
    .week h5 {
      font-weight:200;
    }
    .hovershade:hover{
     background-color:#f9f9f9;
    }
    .footer {
    height:80px;
    text-align:center;
    /*position: absolute;*/
    bottom: 0;
    width: 100%;
    /* Set the fixed height of the footer here */
    background-color: #333;
    }
    .footer h3 {
    margin:20px;
    }
    .item {
    background-color:white;
    /*border-bottom:1px solid #f7f7f7;
     -webkit-box-shadow: 0px 3px 5px 1px #bbb;
       -moz-box-shadow: 0px 3px 5px 1px #bbb;
    box-shadow: 0px 3px 5px 1px #bbb;*/
    }
    .intro {
      overflow-x:hidden;
      background-color:#ddd;
    }
    .item:last-child {
    border-bottom:none;
    }
    #newnav.affix {
    position: fixed;
    top: 0;
    width: 100%;
    /*background-color:rgba(255,255,255,0.85);*/
     -webkit-box-shadow: 0px 0px 8px 2px #A0A0A0;
       -moz-box-shadow: 0px 0px 8px 2px #A0A0A0;
            box-shadow: 0px 0px 8px 2px #A0A0A0;
    /*border-bottom:3px solid black;*/
    }
    #menu {
    /*background-color:rgba(255, 255, 255, 0.85);*/
    text-align:center;
    padding-bottom:10px;
    padding-top:10px;
    }
    #nav {
    -webkit-transition: background-color 0.5s; /* Safari */
    transition: background-color 0.5s;
    /*background-color:#DBEDFF;*/
    }
    .nav li>a:hover{
      background-color: #333 !important;
      color:#A26B2E !important;
    }
    .nav li>a {
    -webkit-transition: background-color 0.5s; /* Safari */
    transition: background-color 0.5s;
    text-transform:uppercase;
    color:#777 !important;
    letter-spacing:1px;

    }
    .navbar-default .navbar-nav>.active>a {
    color: #AE743C !important;
    background-color: #333;
    }
    .navbar-default {
      border:none;
    }
    .navbar {
      border-radius:0px;
      margin-bottom:0px;
    }
    .navbar-brand {
    font-family: boldproxima;
    letter-spacing: 2px;
    text-transform: uppercase;
    color: #A26B2E !important;
    }
    p{
    color:#969696;
    }
    .navbar-default .navbar-collapse, .navbar-default .navbar-form {
    border-color: black;
    }
    a {
      color:#555 !important;
    }
    .label-default {
      background-color:#D4AB82;
    }
  body
    //.language
    //  a#eng Login
    //background-color:#FF9C47;:#e87e22 round button color
    //.modal.fade(id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel")
    //  .modal-dialog(role="document")
    //    .modal-content
    //      .modal-header
    //        button(type="button" class="close" data-dismiss="modal" aria-label="Close")
    //          span(aria-hidden="true") Ã—
    //        h4(class="modal-title"  style='color:#ddd;') Last step
    //      .modal-body
    //        form
    //          .form-group
    //            .message
    //          .inputwrap
    //            #mailgroup.form-group.has-feedback
    //              input(type="email" class=" change_phc simplebox" id="mail" name='mail' placeholder="email") 
    //              span(id='mail_error' style='display:none;' class="glyphicon glyphicon-remove form-control-feedback" aria-hidden="true")
    //              span(id='mail_success'  style='display:none;' class="glyphicon glyphicon-ok form-control-feedback" maxlength="35" aria-hidden="true")
    //            #pgroup.form-group.has-feedback
    //              span(id='p_error' style='display:none;' class="glyphicon glyphicon-remove form-control-feedback" aria-hidden="true")
    //              input(type="password" class=" change_phc simplebox" id="p" name='p' maxlength="15" placeholder="password") 
    //              span(id='p_success'  style='display:none;' class="glyphicon glyphicon-ok form-control-feedback" aria-hidden="true")
    //            #nickgroup.form-group.has-feedback
    //              span(id='nick_error' style='display:none;' class="glyphicon glyphicon-remove form-control-feedback" aria-hidden="true")
    //              span(id='nick_success'  style='display:none;' class="glyphicon glyphicon-ok form-control-feedback" aria-hidden="true")
    //              input(type="text" class="change_phc simplebox" id='nickinput' name='nick' placeholder="nick" maxlength="20")
    //            #pwderr
    //            //input(type="password" class=" change_phc simplebox" id="pc" name='pc' placeholder="Confirm password") 
    //          button.btn.btn-lg.btn-primary.runreg(type='button' style='min-height:40px;background-color:rgba(8, 8, 8, 0.5);border:none;width:100%;text-transform:uppercase;letter-spacing:2px;') Login
    .intro
      .container(id='wait' style='background-color:rgba(0, 0, 0, 0.63);position:fixed;width:100%;height:100%;z-index:9999;display:none;')
        .row(id='spin') 
          .col-xs-12(style='text-align:center;')
            .loader       
      header(style='background-color:#212121;')
        .container
          #mainheading.row(style='padding-bottom:20px;')
            .col-xs-12
              h1(style='text-transform:uppercase;letter-spacing:4px;font-weight:100;color:#AE743C;font-family:boldproxima;') Link Storage
      nav.navbar.navbar-default.navbar-centered#newnav(style='z-index:1000;background-color:#333;')
        .container
          .row 
            .col-xs-12.col-lg-10.col-lg-offfset-1.col-md-10.col-md-offset-1 
              .navbar-header
                button(type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false")
                  span(class="sr-only") Toggle navigation
                  span(class="icon-bar")
                  span(class="icon-bar")
                  span(class="icon-bar")
                a(class="navbar-brand visible-xs" href="#") Link Storage
                //a(class="navbar-brand hidden-xs" style='position:absolute;left:0px;top:0px;' href="#") ANN Research
                //a(class="navbar-brand" href="#") Brand
              .collapse.navbar-collapse#bs-example-navbar-collapse-1
                ul(class="nav navbar-nav")
                  li(class="active")
                    a(href="#") Neural
                      span(class="sr-only") (current)
                      span#numbers(class='badge')
                  li
                    a(href="/ic") IC
                      span#icnumbers(class='badge')
                  li
                    a(href="/b") Business
                      span#bnumbers(class='badge')
                  li
                    a(href="/m") Misc
                      span#mnumbers(class='badge')
                  li
                    a(href="/a") About
      #maincontent.container(style='padding-bottom:30px;')
        #list.row
          .col-xs-12.col-lg-10.col-lg-offset-1.col-md-10.col-md-offset-1               
            .row.brow
              .col-xs-12.visible-lg.visible-md.visible-sm.items#bigscreens
                .noitems.row(style='text-align:center;')  
                   .col-xs-12
                     h2.noitems_text(style='color:#ccc;margin-top:50px;') No items  
            .row.brow
              #smallscreens.visible-xs.col-xs-12.items       
                .noitems.row(style='text-align:center;')  
                   .col-xs-12
                     h2.noitems_text(style='color:#ccc;margin-top:50px;') No items 
      footer.footer
        .container
          .row
            .col-xs-12.col-lg-8.col-lg-offset-2
              h6(style='font-weight:200;color:#5D5C5C;margin-top:20px;') you are never getting in this house
              h5(style='font-weight:200;color:gray;margin-bottom:20px;') 2016
    // jQuery (necessary for Bootstrap's JavaScript plugins)
    //script(src='https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js')
    // Include all compiled plugins (below), or include individual files as needed
    script(src='js/jquery.min.js')
    script(src='js/bootstrap.min.js') 
    script(async src='js/counter.js')    
    script.
      //$('#eng').click(function(){
      //  $('#myModal').modal('show');
      //  });
      var tmstmp = #{tmstmp};
      var last_visit = new Date(parseInt(tmstmp));
      console.log('last visit: '+last_visit);
      var consolidated=[];
       $.ajax({
              method: "POST",
              url: "/getitems",
              data: 0
            }).done(function( msg ) {
                console.log('hey! '+msg);
                if(!msg.trouble) {
                   items=msg.doc;
                  if(!items || !items.length) {
                   console.log('no items');
                   }
                   else {
                    items.forEach(function (element,index){
                    element.item_type = 'article';
                    consolidated.push(element);
                    });
                   }
                   if(consolidated.length){
                    console.log(consolidated);
                   sortByKey(consolidated, 'tmstmp');
                   populate(consolidated);
                 }
                }
              });
      String.prototype.capitalizeFirstLetter = function() {
          return this.charAt(0).toUpperCase() + this.slice(1);
      }
      Date.prototype.getWeek = function() {
        var onejan = new Date(this.getFullYear(), 0, 1);
        return Math.ceil((((this - onejan) / 86400000) + onejan.getDay() + 1) / 7);
      }
      function sortByKey(array, key) {
           return array.sort(function(a, b) {
              var x = parseInt(a[key]); var y = parseInt(b[key]);
              return ((x < y) ? -1 : ((x > y) ? 1 : 0));
          });
       }
       function date_out(tmstmp) {
                  var today = new Date(parseInt(tmstmp));
                var dd = today.getDate();
                var mm = today.getMonth()+1; //January is 0!
                var yyyy = today.getFullYear();
                if(dd<10){
                    dd='0'+dd
                } 
                if(mm<10){
                    mm='0'+mm
                } 
                var today = dd+'.'+mm+'.'+yyyy;
                return today;
                }
      function populate(consolidated) {
      var last_item_over = consolidated[consolidated.length-1];
      var weeknum_g=new Date(last_item_over.tmstmp).getWeek();
       consolidated.forEach(function (element,index){
         if ($(".noitems")[0])
                 { console.log('HAS LENGTH');
                   $('.items').empty();}
                 else {
                   console.log('HASNT GOT LENGTH');
                 }
         var insert;
         var weektxt = 'week';
         switch(element.item_type){
           case('article'):
                var today = date_out(element.tmstmp);
                var num = parseInt(index+1);
                if(consolidated[index-1] && today>date_out(consolidated[index-1].tmstmp)) {
                }
                if(consolidated[index+1] && today===date_out(consolidated[index+1].tmstmp)) {
                  today = '';
                }
                var comment='';
                if(element.comment) {
                  comment = "<p>"+element.comment.capitalizeFirstLetter()+"</p>";
                }
                var label = "<span style='margin-right:10px;' class='label label-default'>New</span>";
                if(tmstmp&&element.tmstmp<tmstmp || !parseInt(tmstmp)) {
                  console.log('no label');
                  label='';
                }
                var heading = "<h4  class='btitle"+element._id+"' >"+label+element.title.capitalizeFirstLetter()+"<small style='margin-left:20px;' class='hidden-xs' ></small></h4>";
                if(element.link!='0') {
                  heading = "<h4 class='btitle"+element._id+"' >"+label+"<span class='glyphicon glyphicon-link' style='color:#ddd;margin-right:10px;font-size:18px;'></span><a href='"+element.link+"'>"+element.title.capitalizeFirstLetter()+"</a><small style='margin-left:20px;' class='hidden-xs' ></small></h4>";
                }
                var weeknum = new Date(parseInt(element.tmstmp));
                weeknum = weeknum.getWeek();
                var week = "<div class='row week week"+weeknum_g+"'><div class='col-sm-2'><h5>"+weektxt+" "+weeknum_g+"</h5></div></div>";
                var weekname = '.week'+weeknum;
                //-------------------------------------//
                var style='';
                var style2="style='border-bottom:1px solid #eee;'";
                if(consolidated[index-1] && date_out(element.tmstmp)!=date_out(consolidated[index-1].tmstmp)) {
                if(consolidated[index+1] && new Date(element.tmstmp).getWeek()<new Date(consolidated[index+1].tmstmp).getWeek()){
                   style="style='border-top-left-radius:3px;border-top-right-radius:3px;";
                   //just before week separator
                }
                if(new Date(element.tmstmp).getWeek()>new Date(consolidated[index-1].tmstmp).getWeek()){
                 style="style='border-bottom-left-radius:3px;border-bottom-right-radius:3px;";
                 style2='';
                 console.log('style2 1');
                 // after week separator
                }
                }
                if(!consolidated[index+1]) {
                  style="style='border-top-left-radius:3px;border-top-right-radius:3px;";
                }
                if(!consolidated[index-1]) {
                  console.log('style2 2');
                  style ="style='border-bottom-left-radius:3px;border-bottom-right-radius:3px;";
                  style2='';
                }
                if(consolidated[index-1] && new Date(parseInt(element.tmstmp)).getDate()>new Date(parseInt(consolidated[index-1].tmstmp)).getDate()) {
                  console.log('style2 3');
                  style2='';
                  style+=style.length?"border-bottom:1px solid #eee;'":"style='border-bottom:1px solid #eee;'";
                }
                else {
                  style+=style.length?"'":'';
                }
                //--------------------------------------//
                insert = "<div "+style+"class='row item read book"+element._id+"'><div class='col-sm-2' style='text-align:center;'><h5 style='color:#d2d2d2;font-weight:200;' class=' hidden-xs' >"+today+" </h5></div><div class='col-sm-10 hovershade good bookpadding' "+style2+">"+heading+"<h5 style='font-weight:300;color:#ccc;' class='hidden-lg hidden-md hidden-sm sm_hd"+element._id+"'>"+today+"</h5>"+comment+"</div></div>";
                if(weeknum>weeknum_g )
                {$('.items').prepend(week); }  
                weeknum_g = weeknum;   
                $('.items').prepend(insert);
                if(index === consolidated.length-1) {
                  //var week = "<div class='row week week"+weeknum+"'><div class='col-xs-12'><h5>"+weektxt+" "+weeknum+"</h5></div></div>";
                  var week = "<div class='row week week"+weeknum+"'><div class='col-sm-2'><h5>"+weektxt+" "+weeknum+"</h5></div></div>";
                  $('.items').prepend(week);
                }
           break;
         }
         });
        };
        $('#newnav').affix({
              offset: {
                top: $('header').height()
              }
        });
        $('#newnav').on('affix.bs.affix',function(){
          $('#maincontent').css('padding-top',$('#newnav').height());
        });
        $('#newnav').on('affix-top.bs.affix',function(){
          $('#maincontent').css('padding-top','0px');
        });