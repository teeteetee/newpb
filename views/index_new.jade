doc
html(lang='en')
head
  meta(charset='utf-8')     
  meta(http-equiv='X-UA-Compatible', content='IE=edge')     
  meta(name='viewport', content='width=device-width, initial-scale=1')
  meta(name='yandex-verification' content='6ea94f8807d25ebe')
  // The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags
  title AC notes     
  link(rel='icon', href='', sizes='16x16', type='image/png')
  // Bootstrap
  link(href='/bootstrap/css/bootstrap.min.css', rel='stylesheet')     
  meta(liber de amicitia est)
  // HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries
  // WARNING: Respond.js doesn't work if you view the page via file://
  //if lt IE 9
  script(src='https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js') 
  script(src='https://oss.maxcdn.com/respond/1.4.2/respond.min.js')     
  style.
    body2{
    height:100%;
    background: #2eb9c9; /* Old browsers */
    background: -moz-linear-gradient(top, #00afce 0%, #00809e 35%, #004f71 100%); /* FF3.6+ */
    background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#00afce), color-stop(35%,#00809e), color-stop(100%,#004f71)); /* Chrome,Safari4+ */
    background: -webkit-linear-gradient(top, #00afce 0%,#00809e 35%,#004f71 100%); /* Chrome10+,Safari5.1+ */
    background: -o-linear-gradient(top, #00afce 0%,#00809e 35%,#004f71 100%); /* Opera 11.10+ */
    background: -ms-linear-gradient(top, #00afce 0%,#00809e 35%,#004f71 100%); /* IE10+ */
    background: linear-gradient(to bottom, #00afce 0%,#00809e 35%,#004f71 100%); /* W3C */
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#00afce', endColorstr='#004f71',GradientType=0 ); /* IE6-9 */
    }
    body{
      height:100%;
     /* background-color:#{color};*/
     background-color:white;
    }
    html2 { 
      background: url('/images/libr.jpg') no-repeat center center fixed; 
      -webkit-background-size: cover;
      -moz-background-size: cover;
      -o-background-size: cover;
      background-size: cover;
    }
    body2{
      background-color:transparent;
    }
    .change_phc::-webkit-input-placeholder {color:#ddd;}
    .change_phc::-moz-placeholder          {color:#ddd;}/* Firefox 19+ */
    .change_phc:-moz-placeholder           {color:#ddd;}/* Firefox 18- */
    .change_phc:-ms-input-placeholder      {color:#ddd;}
    .change_phc {
      color:white;
    }
    .signinlink{
      margin-top:30px;
    }
    .signinlink:focus, .signinlink:hover, .signinlink:active {
      color:white;
    }
    #signup {
      margin-top:50px;
    }
    #signupround {
      margin-top:60px;
    }
    #signupbutton {
      margin-top:30px;
    }
    #mainheading {
      text-align:center;
      margin-top:20px;
    }
    .inputwrap input{
     -webkit-appearance: none;
      border-radius: 0;
      width:100%;
      padding: 11px 10px 11px 13px;
      font-size: 14px;
      line-height: 1.42857143;
      color: #555;
      border:none;
      border-bottom:1px solid #ddd;
    }
    .form-control-feedback {
      top:4px;
      right:4px;
    }
    @media (max-width: 992px) {
        .inputwrap input{
      font-size: 20px !important;
      line-height: 2 !important;
    }
    .form-control-feedback {
      top:16px;
      right:6px;
    }
    p {
      font-size:20px;
    }
    .btn-lg {
      height:60px;
      font-size: 22;
    }
    .signinlink {
      font-size: 22;
    }
    }
    @media (max-width: 767px) {
    h1 {
      font-size:32px;
    }
    .signinlink {
     margin-top:20px;
      }
    #mainheading {
      margin-top: 10px;
    }
    }
    @font-face {
    font-family:roboto-thin;
    src: url('/bootstrap/fonts/Roboto-Thin.ttf');
    }
    @font-face{
    font-family:proxima;
    src:url('/bootstrap/fonts/ProximaNova-Reg-webfont.woff');
    }
    @font-face{
    font-family:boldproxima;
    src:url('/bootstrap/fonts/ProximaNova-Sbold-webfont.woff');
    }
    .loader {
    margin: 60px auto;
    margin-top:20%;
    font-size: 10px;
    position: relative;
    text-indent: -9999em;
    border-top: 1.1em solid rgba(255, 255, 255, 0.2);
    border-right: 1.1em solid rgba(255, 255, 255, 0.2);
    border-bottom: 1.1em solid rgba(255, 255, 255, 0.2);
    border-left: 1.1em solid #ffffff;
    -webkit-transform: translateZ(0);
    -ms-transform: translateZ(0);
    transform: translateZ(0);
    -webkit-animation: load8 1.1s infinite linear;
    animation: load8 1.1s infinite linear;
    }
    .loader,
    .loader:after {
      border-radius: 50%;
      width: 10em;
      height: 10em;
    }
    @-webkit-keyframes load8 {
      0% {
        -webkit-transform: rotate(0deg);
        transform: rotate(0deg);
      }
      100% {
        -webkit-transform: rotate(360deg);
        transform: rotate(360deg);
      }
    }
    @keyframes load8 {
      0% {
        -webkit-transform: rotate(0deg);
        transform: rotate(0deg);
      }
      100% {
        -webkit-transform: rotate(360deg);
        transform: rotate(360deg);
      }
    }
    .inputwrap input{
      font-weight: 500;
     letter-spacing: 1px;
     -webkit-appearance: none;
      border-radius: 0;
      width:100%;
      padding: 11px 10px 11px 13px;
      font-size: 14px;
      line-height: 1.42857143;
      color: #555;
      border:none;
      border-bottom:1px solid #ddd;
    }
    .inputwrap input:first-child {
    -webkit-appearance: none;
    border-radius: 0;
    border-top-left-radius:4px;
    border-top-right-radius:4px;
    border-bottom:none;
    border-bottom: 1px solid #ddd;
    }
    .inputwrap input:last-child {
     -webkit-appearance: none;
    border-radius: 0;
    border-bottom-left-radius:4px;
    border-bottom-right-radius:4px;
    border:none;
    }
    .inputwrap {
      margin-bottom:20px;
    }
    .simplebox {
      outline: none;
      -webkit-box-shadow: none !important;
      -moz-box-shadow: none !important;
      box-shadow: none !important;
    }
    .form-group{
      margin:0px;
    }
    .has-success .form-control-feedback {
    color: #61C782;
    }
    .btn:focus,.btn:active {
       outline: none !important;
    }
    .checkbox label {
    padding-left: 35px;
    }
    #termsrow {
      display:none;
    }
    .modal-header {
      border:none;
    }
    .modal-body{
      padding-top:0px;
    }
    .btn-iosdark {
      background-color:white;
      border:1px solid #333;
      color:#333;
    }
    .btn-iosdark:focus, .btn-iosdark:active, .btn-iosdark:hover {
      background-color:#333;
      color:white;
    }
    .btn-iosdark.active {
      background-color:#333;
      color:white;
    }
    .btn-simple {
      border:none;
      background-color:white;
      color:#2E98F3;
    }
    .btn-blue {
      border-color:#2E98F3;
      background-color:#2E98F3;
      color:white;
    }
    h4 {
      margin-bottom:20px;
    }
    #pwderr {
      background-color:rgba(0, 0, 0, 0.43);
      border-radius:4px;
      color:white;
      display:none;
      padding:20px 16px;
      margin-top:20px;
    }
    .language {
      position:absolute;
      top:20px;
      right:20px;
      color:rgba(0,0,0,0.3) !important;
      }
    .language a,.language a:focus,.language a:active,.language a:hover {
      color:rgba(0,0,0,0.3);
    }
    .modal-header {
    border-top-left-radius: 6px;
    border-top-right-radius: 6px;
    background-color: #333;
    }
    .modal-content{
      border:none;
      box-shadow:none;
    }
  body
    .language
      a#eng Login
    //background-color:#FF9C47;:#e87e22 round button color
    .modal.fade(id="error_Modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel")
      .modal-dialog(role="document")
        .modal-content
          .modal-header
            button(type="button" class="close" data-dismiss="modal" aria-label="Close")
              span(aria-hidden="true") ×
            h4(class="modal-title"  style='color:#ddd;') Error
          .modal-body
            h3( id ='error_text' style='font-weight:200;color:#fc454e;') 
    .modal.fade(id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel")
      .modal-dialog(role="document")
        .modal-content
          .modal-header
            button(type="button" class="close" data-dismiss="modal" aria-label="Close")
              span(aria-hidden="true") ×
            h4(class="modal-title"  style='color:#ddd;') Last step
          .modal-body
            //.col-xs-12.col-sm-6.col-sm-offset-3.col-md-4.col-md-offset-4(id='paddgroup-lg')
            form
              .form-group
                .message
              .inputwrap
                #mailgroup.form-group.has-feedback
                  input(type="email" class=" change_phc simplebox" id="mail" name='mail' placeholder="email") 
                  span(id='mail_error' style='display:none;' class="glyphicon glyphicon-remove form-control-feedback" aria-hidden="true")
                  span(id='mail_success'  style='display:none;' class="glyphicon glyphicon-ok form-control-feedback" maxlength="35" aria-hidden="true")
                #pgroup.form-group.has-feedback
                  span(id='p_error' style='display:none;' class="glyphicon glyphicon-remove form-control-feedback" aria-hidden="true")
                  input(type="password" class=" change_phc simplebox" id="p" name='p' maxlength="15" placeholder="password") 
                  span(id='p_success'  style='display:none;' class="glyphicon glyphicon-ok form-control-feedback" aria-hidden="true")
                #nickgroup.form-group.has-feedback
                  span(id='nick_error' style='display:none;' class="glyphicon glyphicon-remove form-control-feedback" aria-hidden="true")
                  span(id='nick_success'  style='display:none;' class="glyphicon glyphicon-ok form-control-feedback" aria-hidden="true")
                  input(type="text" class="change_phc simplebox" id='nickinput' name='nick' placeholder="nick" maxlength="20")
                #pwderr
                //input(type="password" class=" change_phc simplebox" id="pc" name='pc' placeholder="Confirm password") 
              button.btn.btn-lg.btn-primary.runreg(type='button' style='min-height:40px;background-color:rgba(8, 8, 8, 0.5);border:none;width:100%;text-transform:uppercase;letter-spacing:2px;') Login
    .container(id='wait' style='background-color:rgba(0, 0, 0, 0.63);position:fixed;width:100%;height:100%;z-index:9999;display:none;')
      .row(id='spin') 
        .col-xs-12(style='text-align:center;')
          .loader       
    .container
      #mainheading.row(style='padding-bottom:10px;border-bottom:1px solid #eee;')
        .col-xs-12
          h1(style='text-transform:uppercase;letter-spacing:4px;font-weight:100;color:black;font-family:boldproxima;') Neural Networks Research
          h4(style='color:rgba(0, 0, 0, 0.47);font-weight:200;letter-spacing:1px;' id='modo') Keeping track of the information
      #datablock.row
    // jQuery (necessary for Bootstrap's JavaScript plugins)
    //script(src='https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js')
    // Include all compiled plugins (below), or include individual files as needed
    script(src='js/jquery.min.js')
    script(src='js/bootstrap.min.js') 
    script(async src='js/counter.js')    
    script.
      var less_six = 'Password should be at least 6 chracters long';
        var too_long = 'Password is too long';
        var no_digit = 'Password should contain at least one number';
        var digit_letter = 'Password should contain letters and numbers';
        var email_inuse = 'Provided email is already used by one of the users';
        var email_incorrect = 'Email is not valid';
        var lang = 'en';
        var nick_short = 'Nickname should contain at least 5 characters';
        var nick_taken = 'This nick is alredy in use';
      $('#eng').click(function(){
        $('#myModal').modal('show');
        });
      $('#mail').keyup(function(event) {
        if(!$('#mail').val()){
             $('#mail_error').css('display','none');
             $('#mail_success').css('display','none');
           }
        if($('#mail').val().length>5) {
          if(validateEmail($('#mail').val())){
            $('#mail_error').css('display','none');
            $('#mailgroup').removeClass('has-error').addClass('has-success');
            $('#mail_success').css('display','block');
           }
           else {
            $('#mail_success').css('display','none');
            $('#mailgroup').removeClass('has-success').addClass('has-error');
            $('#mail_error').css('display','block');
           }
          }
        });
      $('#p').keyup(function(event) {
        if(!$('#p').val()) {
          console.log('yeouh');
          $('#pgroup').removeClass('has-success');
            $('#p_success').css('display','none');
            $('#pgroup').removeClass('has-error');
              $('#p_error').css('display','none');
              $('#pwderr').slideToggle();
        }
          else{
        checkPwd($('#p').val());
        }
        });
      var lastentry;
      $('#nickinput').keyup(function(event) {
                      if(!$('#nickinput').val()){
                        $('#nick_error').css('display','block');
                        $('#nickgroup').removeClass('has-success').addClass('has-error');
                        $('#nick_success').css('display','none');
                      }
                      else if($('#nickinput').val().length <5) {
                        $('#nick_error').css('display','block');
                        $('#nickgroup').removeClass('has-success').addClass('has-error');
                        $('#nick_success').css('display','none');
                        $('#pwderr').empty();
                        $('#pwderr').append('<p>'+nick_short+'</p>');
                        if($('#pwderr').css('display') === 'none'){
                          $('#pwderr').slideToggle();
                        }
                       }
                      else if($('#nickinput').val() != lastentry && $('#nickinput').val().length >4) {       
                        str = $('#nickinput').val().replace(/\s+/g, '');
                        $.ajax({
                          method: "POST",
                          url: "/nickcheck",
                          data: { txt: str }
                        }).done(function( msg ) {
                            console.log(msg);
                            if(msg.present)
                              { 
                                console.log('msg present');
                                $('#nick_success').css('display','none');
                                $('#nickgroup').removeClass('has-success').addClass('has-error');
                                $('#nick_error').css('display','block');
                                 lastentry = $('#nickinput').val();
                                
                                }
                                          else {
                                            console.log('no msg');
                                          
                                            $('#nick_error').css('display','none');
                                            $('#nickgroup').removeClass('has-error').addClass('has-success');
                                            $('#nick_success').css('display','block');
                                            $('#pwderr').css('display','none');
                                            lastentry = $('#nickinput').val();
                                          }
                              });
                      }
                       lastentry = $('#nickinput').val()
                      });
      $('#male').click(function(){
        if($('#male').hasClass('active')){
        }
        else{
          $('#male').addClass('active');
          $('#female').removeClass('active');
        }
        });
      $('#female').click(function(){
        if($('#female').hasClass('active')){
        }
        else{
          $('#female').addClass('active');
          $('#male').removeClass('active');
        }
        });
       $('.runreg').click(function(){
          console.log('runreg '+$('#terms_checkbox').is(':checked'));
           if(validateEmail($('#mail').val()) && $('#p').val() && $('#terms_checkbox').is(':checked')  && $('#nickgroup').hasClass('has-success')) {
            runregister();
          }
          else if(validateEmail($('#mail').val()) && $('#p').val() && $('#nickgroup').hasClass('has-success') && $('#pgroup').hasClass('has-success') && $('#myModal').css('display') === 'none'){
            $('#myModal').modal('show');
          }
        });
        $(document).keypress(function(e) { 
          var vm = $('#mail').val();
          var vp = $('#p').val();
          var vn = $('#nickinput').val();
          if(e.which ==13 && validateEmail(vm) && $('#p').val() && $('#nickgroup').hasClass('has-success') && $('#pgroup').hasClass('has-success') && $('#myModal').css('display') === 'none') {
              console.log('keypress first scenario');
              $('#myModal').modal('show');
          }
          if(e.which == 13&& validateEmail(vm) && vp && $('#terms_checkbox').is(':checked') && $('#nickgroup').hasClass('has-success') && vn) {
            console.log('keypress second scenario');
            runregister();
          }
      });
         //-------REGISTER--------
        function validateEmail(email) { 
        console.log('checking email');
        var re = /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
        return re.test(email);} 
        function checkPwd(str) {
        //if($('#p').val('')) {
        // if($('#pwderr').css('display','block')){
        //      $('#pwderr').slideToggle();
        //    }
        //    $('#pgroup').removeClass('has-success has-error');
        //    $('#p_success').css('display','none');
        //    $('#p_error').css('display','none');
        //}
        //if($('#p_success').css('display','block')){
        //  $('#pgroup').removeClass('has-success');
        //  $('#p_success').css('display','none');
        //}
        if (str.length < 6) {
            $('#pwderr').empty();
            console.log(1);
            $('#pwderr').append('<p>'+less_six+'</p>');
            if($('#pgroup').hasClass('has-success')){
              $('#pgroup').removeClass('has-success');
              $('#p_success').css('display','none');
            }
            if($('#pwderr').css('display') === 'none'){
              console.log(2);
              $('#pwderr').slideToggle();
            }
            $('#pgroup').addClass('has-error');
              $('#p_error').css('display','block');
           // return("too_short");
        } else if (str.length > 50) {
          console.log(3);
            $('#pwderr').empty();
            $('#pwderr').append('<p>'+too_short+'</p>');
            if($('#pgroup').hasClass('has-success')){
              $('#pgroup').removeClass('has-success');
              $('#p_success').css('display','none');
            }
            if($('#pwderr').css('display') === 'none'){
              console.log(4);
              $('#pwderr').slideToggle();
            }
            $('#pgroup').addClass('has-error');
              $('#p_error').css('display','block');
            //return("too_long");
        } else if (str.search(/\d/) == -1) {
          console.log(5);
            $('#pwderr').empty();
            $('#pwderr').append('<p>'+no_digit+'</p>');
            if($('#pgroup').hasClass('has-success')){
              $('#pgroup').removeClass('has-success');
              $('#p_success').css('display','none');
            }
            if($('#pwderr').css('display') === 'none'){
              console.log(6);
              $('#pwderr').slideToggle();
            }
            $('#pgroup').addClass('has-error');
              $('#p_error').css('display','block');
            //return("no_num");
        } else if (str.search(/[a-zA-Z]/) == -1) {
          console.log(7);
            $('#pwderr').empty();
            $('#pwderr').append('<p>'+digit_letter+'</p>');
            if($('#pgroup').hasClass('has-success')){
              $('#pgroup').removeClass('has-success');
              $('#p_success').css('display','none');
            }
            if($('#pwderr').css('display') === 'none'){
              console.log(8);
              $('#pwderr').slideToggle();
            }
            $('#pgroup').addClass('has-error');
              $('#p_error').css('display','block');
            //return("no_letter");
        } //else if (str.search(/[^a-zA-Z0-9\!\@\#\$\%\^\&\*\(\)\_\+]/) != -1) {
          //  $('#pwderr').empty();
          //  $('#pwderr').append('<p>Password requires at leas five letters</p>');
          //  if($('#pwderr').css('display') === 'none'){
          //    $('#pwderr').slideToggle();
          //  }
          //  return("bad_char");
          //}
        //return("ok");
        else {
          console.log(9);
        if($('#pwderr').css('display') ==='block'){
          console.log(10);
              $('#pwderr').slideToggle();
            }
        $('#pgroup').removeClass('has-error');
        $('#p_error').css('display','none');
        $('#p_success').css('display','block');
        $('#pgroup').addClass('has-success');
        }
        }
        //--------------------
        // RUNREGISTER FUNCTION
        //---------------------
        function runregister() {
          $('#wait').css('display','block');
         var errcount =0;
         var vp = $('#p').val();
         var vn = $('#nickinput').val();
         var vmail = $('#mail').val();
        $('.message').empty();
        console.log(vp.length);
        var male=1;
        if(!$('#male').hasClass('active')){
          male=0;
        }
        if(vp.length === 0 ) {
        console.log('pass length 0');
        //$('.message').append("<h5 style='color:#fc454e;'>Provide a password, and verify it</h5>");
        $('#error_text').text(less_six);
        $('#error_Modal').modal('show');
        $('#p').empty();
        errcount++;
        }
        console.log(vmail);
        if(!validateEmail(vmail))
        {
        //$('.message').append("<h5 style='color:#fc454e;'>incorrect email</h5>");
        $('#error_text').text(email_incorrect);
        $('#error_Modal').modal('show');
        errcount++;
        }
        if(errcount!=0) {
          return;
        }
        console.log('submitting now');
        //$("#regform").submit();
        request = new XMLHttpRequest();
        request.onreadystatechange = function () {
        var DONE = this.DONE || 4;
        if (this.readyState === DONE){
        parsed = JSON.parse(request.responseText);
        console.log(parsed);
        // do your job here
        if (parsed.trouble === 1)
        {
        $('.message').empty();
        switch (parsed.mtext)
        {
        case('fail'):
        //$('.message').append("<h5 style='color:#fc454e;'>Sorry, omething is slightly off with the DB, try again in a couple of minutes or contact support</h5>");
        $('#error_text').text('Network Error');
        $('#error_Modal').modal('show');
        break;
        case('email exists'):
        //$('.message').append("<h5 style='color:#fc454e;'>Provided email is already used by one of the users</h5>");
        $('#error_text').text('email_inuse');
        $('#error_Modal').modal('show');
        break;
        
        }
        }
        else { window.location = 'http://peopleandbooks.com';}
        }
        };
        request.open('POST', '/newuser', true);
        request.setRequestHeader('X-Requested-With', 'XMLHttpRequest');  // Tells server that this call is made for ajax purposes.
        request.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
        // Most libraries like jQuery/Prototype/Dojo do this
        request.send("mail="+vmail+"&p="+vp+"&gn="+male+"&nick="+vn+"&lang="+lang);
          }
        