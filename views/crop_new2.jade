doc
html(lang='en')
head
  meta(charset='utf-8')     
  meta(http-equiv='X-UA-Compatible', content='IE=edge')     
  meta(name='viewport', content='width=device-width, initial-scale=1')
  // The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags
  title P&B     
  link(rel='icon', href='', sizes='16x16', type='image/png')
  // Bootstrap
  link(href='/bootstrap/css/bootstrap.min.css', rel='stylesheet')  
  link(rel="stylesheet" href="/stylesheets/darkroom.css"  type="text/css")  
  meta(liber de amicitia est)
  // HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries
  // WARNING: Respond.js doesn't work if you view the page via file://
  //if lt IE 9
  script(src='https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js')
  script(src='https://oss.maxcdn.com/respond/1.4.2/respond.min.js') 
  script(src='/js/fabric.js')  
  script(src='/js/darkroom.js')     
  style.
    #spin {
    margin-top:15%
    }
    .list {
    overflow:auto;
    min-height:500px;
    max-height:70vh;
    padding-top:20px;
    }
    @media (max-width: 767px) {
    #spin {
    margin-top:30%
    }
    .list {
      max-height:inherit;
    }
    .paddgroup {
    padding-left:25px;
    padding-right:25px;
    }
    #signup {
      background-color:#333;
    }
    }
    @media (max-width: 992px) {
    #spin {
    margin-top:20%
    }
    #booklist {
    border-bottom-left-radius:10px;
    }
    .things{
    padding-top:50px;
    }
    .list {
    padding-top:50px;
    }
    }
    @font-face {
    font-family:roboto-thin;
    src: url('/bootstrap/fonts/Roboto-Thin.ttf');
    }
    @font-face{
    font-family:proxima;
    src:url('/bootstrap/fonts/ProximaNova-Reg-webfont.woff');
    }
    @font-face{
    font-family:boldproxima;
    src:url('/bootstrap/fonts/ProximaNova-Sbold-webfont.woff');
    }
    .thin {
    height:85%;
    }
    .inleftblock {
    border-bottom:1px solid #eee;
    color:gray;
    -webkit-transition: background-color 0.3s ease;
    -moz-transition: background-color 0.3s ease;
    -o-transition: background-color 0.3s ease;
    transition: background-color 0.3s ease;
    }
    .btncorr {
    font-family:boldproxima;
    text-transform:uppercase;
    }
    #heyopen {
    -webkit-box-shadow: inset 0px 7px 17px -9px rgba(0,0,0,0.75);
    -moz-box-shadow: inset 0px 7px 17px -9px rgba(0,0,0,0.75);
    box-shadow: inset 0px 7px 17px -9px rgba(0,0,0,0.75);
    }
    .btn {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    }
    .btn-success {
    background-color:#23BBA7;
    border-color:#1FAB98;
    }
    .btn-success:hover {
    background-color:#1F9E8E;
    } 
    a:hover, a:focus, a:active {
      text-decoration:none !important;
      color:inherit !important;
    }
    .cpadding {
     padding-left:30px;
     padding-right:30px;
    }
    .txtleft {
      text-align:left;
    }
    dl {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    }
    dl dt,dd {
      margin-top:5px;
      margin-bottom:5px;
    }
    form {
      font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    }
    #cropresult {
        width:130px;
        height:130px;
    }
    .mini{
        margin:5px;
    }  
    .loader {
    margin: 60px auto;
    font-size: 10px;
    position: relative;
    text-indent: -9999em;
    border-top: 1.1em solid rgba(255, 255, 255, 0.2);
    border-right: 1.1em solid rgba(255, 255, 255, 0.2);
    border-bottom: 1.1em solid rgba(255, 255, 255, 0.2);
    border-left: 1.1em solid #ffffff;
    -webkit-transform: translateZ(0);
    -ms-transform: translateZ(0);
    transform: translateZ(0);
    -webkit-animation: load8 1.1s infinite linear;
    animation: load8 1.1s infinite linear;
    }
    .loader,
    .loader:after {
      border-radius: 50%;
      width: 10em;
      height: 10em;
    }
    @-webkit-keyframes load8 {
      0% {
        -webkit-transform: rotate(0deg);
        transform: rotate(0deg);
      }
      100% {
        -webkit-transform: rotate(360deg);
        transform: rotate(360deg);
      }
    }
    @keyframes load8 {
      0% {
        -webkit-transform: rotate(0deg);
        transform: rotate(0deg);
      }
      100% {
        -webkit-transform: rotate(360deg);
        transform: rotate(360deg);
      }
    }
    .jcrop-holder {
      margin:auto;
    }
  body(style='background-color:#fbfbfb;')
    nav.navbar.navbar-default.navbar-fixed-top.navbar-inverse(style='border:0px;margin-bottom:0px;')
      .container
        // Brand and toggle get grouped for better mobile display
        .navbar-header
          button.navbar-toggle.collapsed(type='button', data-toggle='collapse', data-target='#bs-example-navbar-collapse-1')
            span.sr-only Toggle navigation         
            span.icon-bar         
            span.icon-bar         
            span.icon-bar       
          a.navbar-brand(style='padding-top:5px;', href='/')
            img(src='/images/pb_inf_logo.png', style='border:1px solid #444;border-radius:50%;', height='40', width='40')
        // Collect the nav links, forms, and other content for toggling
        #bs-example-navbar-collapse-1.collapse.navbar-collapse
          ul.nav.navbar-nav
            li
              a(href='/')  My lists             
            li
              a(href='/people') People           
            li.active
              a(href='/settings')  Settings                      
          ul.nav.navbar-nav.navbar-right
            li
              a(href='/logout') Logout 
    .container(id='wait' style='background-color:rgba(0, 0, 0, 0.63);position:fixed;width:100%;height:100%;z-index:9999;')
      .row(id='spin') 
        .col-xs-12(style='text-align:center;')
          .loader
    .container#main(style='padding-top:100px;height:100%;background-color:white;')          
      .row.optlist(style='display:none;')
        input(id='ar_lock',type='checkbox')
        input(id='size_lock',type='checkbox')
      .row
        .col-xs-12(id='targetbucket')
          img#target(src='#{imgsrc}',class='img-responsive center-block' alt='[Jcrop Example]')
      .row
        .col-xs-12(style='text-align:center;padding-top:30px;')
          button(id='release' style='margin-right:10px;display:none' class='btn btn-primary') Убрать выделение
          button(id='crop' class='btn btn-primary') Обрезать
          .inline-labels(style='display:none;')
            label
              | X1 
              input#x1(type='text', size='4', name='x1')    
            label
              | Y1 
              input#y1(type='text', size='4', name='y1')    
            label
              | X2 
              input#x2(type='text', size='4', name='x2')    
            label
              | Y2 
              input#y2(type='text', size='4', name='y2')    
            label
              | W 
              input#w(type='text', size='4', name='w')    
            label
              | H 
              input#h(type='text', size='4', name='h')
      .row
        .col-xs-12#cropresult
      script(src='https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js')
      script(src='/js/jquery.Jcrop.min.js')
      script(src='/js/crop.js')
      script(src='/js/bootstrap.min.js')
      script.
        $(window).load(function(){
          console.log('remove');
          $('#wait').remove();
           new Darkroom('#target', {
           // Canvas initialization size
           minWidth: 100,
           minHeight: 100,
           maxWidth: 1000,
           maxHeight: 700,
         
           // Plugins options
           plugins: {
             crop: {
               minHeight: 300,
               minWidth: 300,
               maxWidth: 700,
               maxHeight: 700,
               ratio: 1
             },
             save: false // disable plugin
           },
         
           // Post initialization method
           initialize: function() {
             // Active crop selection
             this.plugins['crop'].requireFocus();
         
             // Add custom listener
             //this.addEventListener('core:transformation', function() { /* ... */ });
           }
         });
          });
        
      